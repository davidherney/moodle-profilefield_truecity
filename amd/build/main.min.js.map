{"version":3,"file":"main.min.js","sources":["../src/main.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Main code to support true city profile field.\n *\n * @module     profilefield_truecity/main\n * @copyright  2025 David Herney @ BambuCo\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport $ from 'jquery';\nimport Modal from 'core/modal_save_cancel';\nimport ModalEvents from 'core/modal_events';\nimport Notification from 'core/notification';\nimport Log from 'core/log';\nimport {get_strings as getStrings} from 'core/str';\n\n/**\n * @type {jQuery|HTMLElement} Base container for the true city selector\n */\nvar $cotainerbase;\n\n/**\n * @type {jQuery|HTMLElement} Country select list element\n */\nvar $countrylist;\n\n/**\n * @type {jQuery|HTMLElement} Region select list element\n */\nvar $regionlist;\n\n/**\n * @type {jQuery|HTMLElement} City select list element\n */\nvar $citylist;\n\n/**\n * @type {jQuery|HTMLElement} Modal body container\n */\nvar $modalbody;\n\n/**\n * @type {any} Currently selected location data\n */\nvar currentSelected = null;\n\n/**\n * @type {string} Base URL for AJAX requests in order to fetch location data: countries, regions, and cities.\n */\nvar baseurl;\n\n/**\n * Strings to load from server.\n *\n * @type {Array}\n */\nvar strings = [\n    {key: 'failedtoloadcountrydata', component: 'profilefield_truecity'},\n    {key: 'failedtoloadregiondata', component: 'profilefield_truecity'},\n    {key: 'invalidregionsdataformat', component: 'profilefield_truecity'},\n    {key: 'locationtext', component: 'profilefield_truecity', param: {city: '[CITY]', country: '[COUNTRY]'}},\n    {key: 'notset', component: 'profilefield_truecity'},\n    {key: 'selectacity', component: 'profilefield_truecity'},\n    {key: 'selectaregion', component: 'profilefield_truecity'},\n    {key: 'selectlocationtitle', component: 'profilefield_truecity'},\n    {key: 'unknownregion', component: 'profilefield_truecity'},\n];\n\n/**\n * Loaded strings.\n *\n * @type {Array}\n */\nvar s = [];\n\n/**\n * Load strings from server.\n */\nasync function loadStrings() {\n    strings.forEach(one => {\n        s[one.key] = one.key;\n    });\n\n    await getStrings(strings).then(function(results) {\n        var pos = 0;\n        strings.forEach(one => {\n            console.log('Loaded string: ' + one.key + ' = ' + results[pos]);\n            s[one.key] = results[pos];\n            pos++;\n        });\n        return true;\n    }).fail(function(e) {\n        Log.debug('Error loading strings');\n        Log.debug(e);\n    });\n}\n// End of Load strings.\n\n/**\n * Initialize module\n *\n * @param {string} uniqid Unique identifier for the field instance.\n * @param {string} url Base URL for AJAX requests in order to fetch location data: countries, regions, and cities.\n */\nexport const init = async(uniqid, url) => {\n    baseurl = url;\n\n    await loadStrings();\n\n    const selectorid = `#truecity-selector-${uniqid}`;\n    $cotainerbase = $(`${selectorid}`);\n    $countrylist = $(`${selectorid} select[name=\"profilefield_truecity_country\"]`);\n    $regionlist = $(`${selectorid} select[name=\"profilefield_truecity_region\"]`);\n    $citylist = $(`${selectorid} select[name=\"profilefield_truecity_city\"]`);\n\n    // Load current selected value from hidden input.\n    const $hiddenInput = $('input[data-targetvalue=\"' + uniqid + '\"]');\n    const currentValue = $hiddenInput.val();\n    if (currentValue) {\n        try {\n            currentSelected = JSON.parse(currentValue);\n        } catch (e) {\n            Log.debug('profilefield_truecity', 'Error parsing current location JSON: ' + e);\n        }\n    }\n\n    $modalbody = $cotainerbase.find('.modal-body');\n\n    var selectorModal;\n\n    console.log('Creating modal for truecity selector');\n    // Create and show modal with the selector content\n    Modal.create({\n        title: s.selectlocationtitle,\n        body: `<div id=\"${selectorid.substring(1)}-modal\" class=\"truecity-selector-modal\"></div>`,\n    }).then(function(modal) {\n        selectorModal = modal;\n\n        // Add event listener for save button\n        modal.getRoot().on(ModalEvents.save, function() {\n            // Get selected values\n            const selectedCountry = $countrylist.val();\n            const selectedRegion = $regionlist.val();\n            const selectedCity = $citylist.val();\n\n            // Validate that all required values are selected.\n            if (!selectedCountry || !selectedRegion || !selectedCity) {\n                arguments[0].preventDefault();\n                $modalbody.find('.alert').remove();\n                $modalbody.prepend('<div class=\"alert alert-danger\" role=\"alert\">' + s.selectacity + '</div>');\n                return;\n            }\n\n            const countryName = $countrylist.find('option:selected').text();\n            const regionName = $regionlist.find('option:selected').text();\n            const cityName = $citylist.find('option:selected').text();\n\n            // Create JSON object with values and names\n            const locationData = {\n                country: {\n                    value: selectedCountry,\n                    name: countryName\n                },\n                region: {\n                    value: selectedRegion,\n                    name: regionName\n                },\n                city: {\n                    value: selectedCity,\n                    name: cityName\n                }\n            };\n\n            // Update location text display\n            const locationText = s.locationtext\n                .replace('[COUNTRY]', countryName)\n                .replace('[CITY]', cityName);\n\n            $cotainerbase.find('.truecity-information [data-locationtext]').text(locationText);\n\n            // Store JSON string in hidden input\n            $hiddenInput.val(JSON.stringify(locationData));\n\n            // Close modal after save\n            modal.hide();\n        });\n\n        return modal;\n    }).catch(Notification.exception);\n\n    $cotainerbase.find('.truecity-information [data-act=\"openselector\"]').on('click', function() {\n        selectorModal.show();\n        $(`${selectorid}-modal`).append($modalbody);\n        $modalbody.removeClass('hidden');\n    });\n\n    // Get the currently selected country.\n    const selectedCountry = $countrylist.val();\n    $countrylist.on('change', function() {\n        const countryCode = $(this).val();\n        $modalbody.find('.alert').remove();\n\n        // Deselect and clear region and city selects\n        deselectAutocompleteItems($regionlist);\n        deselectAutocompleteItems($citylist);\n        clearSelect($regionlist);\n        clearSelect($citylist);\n\n        if (countryCode && countryCode != '') {\n            loadCountryRegions(countryCode);\n        }\n    });\n\n    // If a country is selected, fetch its JSON data.\n    if (selectedCountry) {\n        // Clear currentSelected if country not matches.\n        if (currentSelected && currentSelected.country && currentSelected.country.value !== selectedCountry) {\n            currentSelected = null;\n        }\n\n        loadCountryRegions(selectedCountry);\n    }\n};\n\n/**\n * Load regions for a given country.\n *\n * @param {string} countryCode The selected country code.\n */\nfunction loadCountryRegions(countryCode) {\n    const countryuri = `${baseurl}/countries`;\n    const countryJsonUrl = `${countryuri}/${countryCode}.json`;\n\n    $.ajax({\n        url: countryJsonUrl,\n        method: 'GET',\n        dataType: 'json',\n        success: function(data) {\n            if (Array.isArray(data)) {\n                // Handle the country data.\n                populateRegions(data);\n            } else {\n                Log.debug('profilefield_truecity', 'Invalid regions data format');\n                Notification.exception(new Error(s.invalidregionsdataformat));\n            }\n        },\n        error: function(xhr, status, error) {\n            Log.debug('profilefield_truecity', 'Error fetching country data: ' + error);\n            Notification.exception(new Error(s.failedtoloadcountrydata));\n        }\n    });\n}\n\n/**\n * Populate the regions dropdown based on the selected country.\n *\n * @param {Array} regions Array of region objects.\n */\nfunction populateRegions(regions) {\n    // Deselect all options first\n    $regionlist.find('option').prop('selected', false);\n\n    // Clear and repopulate the select\n    $regionlist.empty();\n    $regionlist.append('<option value=\"\"></option>');\n\n    regions = regions.sort((a, b) => a.n.localeCompare(b.n));\n    regions.forEach(region => {\n        let name = region.n;\n        if (!name || name.trim() === '' || name == 'UNKNOWN') {\n            name = s.unknownregion;\n        }\n        $regionlist.append(`<option value=\"${region.i}\">${name}</option>`);\n    });\n\n    if (currentSelected && currentSelected.region) {\n        // Preselect the region if available.\n        $regionlist.val(currentSelected.region.value);\n        currentSelected.region = null;\n    } else {\n        // Set to empty value explicitly.\n        $regionlist.val('');\n    }\n\n    // Trigger change event to update autocomplete UI.\n    $regionlist.trigger('change');\n\n    // Get the currently selected region.\n    const selectedRegion = $regionlist.val();\n\n    // Add event listener for region change (only once).\n    $regionlist.off('change.truecity').on('change.truecity', function() {\n        const regionCode = $(this).val();\n        const countryCode = $countrylist.val();\n        $modalbody.find('.alert').remove();\n\n        deselectAutocompleteItems($citylist);\n        clearSelect($citylist);\n\n        if (regionCode && regionCode != '' && countryCode) {\n            loadRegionCities(countryCode, regionCode);\n        }\n    });\n\n    // If a region is already selected, load its cities.\n    if (selectedRegion && selectedRegion != '') {\n        const countryCode = $countrylist.val();\n        loadRegionCities(countryCode, selectedRegion);\n    }\n}\n\n/**\n * Load cities for a given country and region.\n *\n * @param {string} countryCode The selected country code.\n * @param {string} regionCode The selected region code.\n */\nfunction loadRegionCities(countryCode, regionCode) {\n    const regionuri = `${baseurl}/regions`;\n    const regionJsonUrl = `${regionuri}/${countryCode}_${regionCode}.json`;\n\n    $.ajax({\n        url: regionJsonUrl,\n        method: 'GET',\n        dataType: 'json',\n        success: function(data) {\n            if (Array.isArray(data)) {\n                // Handle the country data.\n                populateCities(data);\n            } else {\n                Log.debug('profilefield_truecity', 'Invalid cities data format');\n                Notification.exception(new Error(s.invalidregionsdataformat));\n            }\n        },\n        error: function(xhr, status, error) {\n            Log.debug('profilefield_truecity', 'Error fetching region data: ' + error);\n            Notification.exception(new Error(s.failedtoloadregiondata));\n        }\n    });\n}\n\n/**\n * Populate the cities dropdown based on the selected region.\n *\n * @param {Array} cities Array of city objects.\n */\nfunction populateCities(cities) {\n    // Deselect all options first\n    $citylist.find('option').prop('selected', false);\n\n    $citylist.empty();\n    $citylist.append('<option value=\"\"></option>');\n\n    cities = cities.sort((a, b) => a.n.localeCompare(b.n));\n    cities.forEach(city => {\n        $citylist.append(`<option value=\"${city.i}\">${city.n}</option>`);\n    });\n\n    if (currentSelected && currentSelected.city) {\n        // Preselect the city if available.\n        $citylist.val(currentSelected.city.value);\n        currentSelected.city = null;\n    } else {\n        // Set to empty value explicitly.\n        $citylist.val('');\n    }\n\n    // Add event listener for city change (only once).\n    $citylist.off('change.truecity').on('change.truecity', function() {\n        $modalbody.find('.alert').remove();\n    });\n\n    // Trigger change event to update autocomplete UI\n    $citylist.trigger('change');\n}\n\n/**\n * Clear a select element and reset it to empty state.\n * Works with autocomplete-enhanced selects.\n *\n * @param {jQuery} $select The select element to clear.\n */\nfunction clearSelect($select) {\n    // First, deselect all options before removing them\n    $select.find('option').prop('selected', false);\n\n    // Now empty and add blank option\n    $select.empty();\n    $select.append('<option value=\"\"></option>');\n    $select.val('');\n\n    // Trigger change to update autocomplete UI\n    $select.trigger('change');\n}\n\n/**\n * Deselect all items in an autocomplete-enhanced select by clicking on the badges.\n * This properly triggers the autocomplete's deselection logic.\n *\n * @param {jQuery} $select The select element to deselect items from.\n */\nfunction deselectAutocompleteItems($select) {\n    // The autocomplete elements are added to the same container as the original select.\n    const $parent = $select.parent();\n\n    // Find the selection container (where the badges are shown).\n    // Class .form-autocomplete-selection is standard for Moodle autocomplete.\n    const $selectionContainer = $parent.find('.form-autocomplete-selection');\n\n    if (!$selectionContainer.length) {\n        return;\n    }\n\n    // Find all selected items (badges).\n    const $selectionItems = $selectionContainer.find('[role=\"option\"]');\n\n    // Click on each badge to trigger the deselection logic of the autocomplete component.\n    $selectionItems.each(function() {\n        $(this).trigger('click');\n    });\n\n    // Clear any remaining active value state on the container.\n    $selectionContainer.attr('data-active-value', '');\n}\n"],"names":["_interopRequireDefault","e","__esModule","default","$cotainerbase","$countrylist","$regionlist","$citylist","$modalbody","_jquery","_modal_save_cancel","_modal_events","_notification","_log","baseurl","currentSelected","strings","key","component","param","city","country","s","loadCountryRegions","countryCode","countryuri","concat","countryJsonUrl","$","ajax","url","method","dataType","success","data","Array","isArray","regions","find","prop","empty","append","sort","a","b","n","localeCompare","forEach","region","name","trim","unknownregion","i","val","value","trigger","selectedRegion","off","on","regionCode","this","remove","deselectAutocompleteItems","clearSelect","loadRegionCities","populateRegions","Log","debug","Notification","exception","Error","invalidregionsdataformat","error","xhr","status","failedtoloadcountrydata","regionuri","regionJsonUrl","cities","populateCities","failedtoloadregiondata","$select","$selectionContainer","parent","length","each","attr","_exports","init","async","uniqid","one","getStrings","get_strings","then","results","pos","console","log","fail","loadStrings","selectorid","$hiddenInput","currentValue","JSON","parse","selectorModal","Modal","create","title","selectlocationtitle","body","substring","modal","getRoot","ModalEvents","save","selectedCountry","selectedCity","arguments","preventDefault","prepend","selectacity","countryName","text","regionName","cityName","locationData","locationText","locationtext","replace","stringify","hide","catch","show","removeClass"],"mappings":"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"}